<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Johannes Krietsch" />

<meta name="date" content="2018-03-29" />

<title>Wind animation with tracks</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Wind animation with tracks</h1>
<h4 class="author"><em>Johannes Krietsch</em></h4>
<h4 class="date"><em>2018-03-29</em></h4>



<p>This file describes the final step (based on vignettes 1 to 4) of creating an animation of the wind as particle flow together with bird tracks which are coloured with the wind support that they experienced flying in these wind conditions.</p>
<p><strong>Summary</strong></p>
<ol style="list-style-type: decimal">
<li>Prepare base map</li>
<li>Create particle flow animation with tracks coloured with wind support</li>
</ol>
<div id="load-packages-load-wind-particles-and-tracking-data-set-working-directory" class="section level2">
<h2>1. Load packages, load wind particles and tracking data, set working directory</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Packages</span>
<span class="kw">sapply</span>(<span class="kw">c</span>(<span class="st">'magrittr'</span>, <span class="st">'data.table'</span>, <span class="st">'foreach'</span>, <span class="st">'windR'</span>, <span class="st">'raster'</span>, <span class="st">'foreach'</span>, <span class="st">'doParallel'</span>, <span class="st">'ggplot2'</span>, <span class="st">'stringr'</span>, <span class="st">'grid'</span>, <span class="st">'rgeos'</span>),
       <span class="cf">function</span>(x) <span class="kw">suppressPackageStartupMessages</span>(<span class="kw">require</span>(x , <span class="dt">character.only =</span> <span class="ot">TRUE</span>, <span class="dt">quietly =</span> <span class="ot">TRUE</span>) ) )
<span class="co">#&gt;   magrittr data.table    foreach      windR     raster    foreach </span>
<span class="co">#&gt;       TRUE       TRUE       TRUE       TRUE       TRUE       TRUE </span>
<span class="co">#&gt; doParallel    ggplot2    stringr       grid      rgeos </span>
<span class="co">#&gt;       TRUE       TRUE       TRUE       TRUE       TRUE</span>

<span class="co"># Projection (polar Lambert azimuthal equal-area with longitude origin 156.65Â° W)</span>
PROJ   =<span class="st"> '+proj=laea +lat_0=90 +lon_0=-156.653428 +x_0=0 +y_0=0 +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0 '</span>

<span class="co"># load particles and calculate the wind speed</span>
particle_data =<span class="st"> </span><span class="kw">system.file</span>(<span class="st">'Map'</span>, <span class="st">'Wind_particles.RDS'</span>, <span class="dt">package =</span> <span class="st">'windR'</span>)
ob =<span class="st"> </span><span class="kw">readRDS</span>(particle_data)
<span class="kw">setkey</span>(ob, datetime_)
ob[, w_speed <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">sqrt</span>(u<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>v<span class="op">^</span><span class="dv">2</span>)]

<span class="co"># Load tracks with wind support</span>
d =<span class="st"> </span>PESA_example_ws
d[, datetime_ <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.POSIXct</span>(datetime_)]

<span class="co"># Specify directory</span>
wd =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">getwd</span>(), <span class="st">'/temp'</span>)
<span class="co"># wd = tempdir() # temporary in this case (choose yourself)</span></code></pre></div>
</div>
<div id="prepare-base-map" class="section level2">
<h2>1. Prepare base map</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># load wind data</span>
wind_data =<span class="st"> </span><span class="kw">system.file</span>(<span class="st">'ERA_Interrim'</span>, <span class="st">'ERA_Interrim_850mb_4_7_June_2014_10km.RDS'</span>, <span class="dt">package =</span> <span class="st">'windR'</span>)
w =<span class="st"> </span><span class="kw">readRDS</span>(wind_data)

<span class="co"># Get borders of the wind data</span>
w1 =<span class="st"> </span>w[datetime_ <span class="op">==</span><span class="st"> </span><span class="kw">unique</span>(w<span class="op">$</span>datetime_[<span class="dv">1</span>])]
wp =<span class="st"> </span><span class="kw">SpatialPoints</span>(<span class="kw">cbind</span>(w1<span class="op">$</span>x, w1<span class="op">$</span>y), <span class="dt">proj4string =</span> <span class="kw">CRS</span>(PROJ))
datBdry =<span class="st"> </span><span class="kw">gEnvelope</span>(wp)

<span class="co"># load high resolution map of area and crop with data boundary</span>
map_data =<span class="st"> </span><span class="kw">system.file</span>(<span class="st">'Map'</span>, <span class="st">'Arctic_map.RDS'</span>, <span class="dt">package =</span> <span class="st">'windR'</span>)
arctic =<span class="st"> </span><span class="kw">readRDS</span>(map_data)
BRW =<span class="st"> </span>arctic <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gIntersection</span>(datBdry)

<span class="co"># Create simple base map</span>
b  =<span class="st"> </span>datBdry <span class="op">%&gt;%</span><span class="st"> </span>fortify <span class="op">%&gt;%</span><span class="st"> </span>data.table
bb =<span class="st"> </span><span class="kw">gBuffer</span>(datBdry, <span class="dt">width =</span> <span class="dv">30000</span>) <span class="op">%&gt;%</span><span class="st"> </span>gEnvelope <span class="op">%&gt;%</span><span class="st"> </span>fortify <span class="op">%&gt;%</span><span class="st"> </span>data.table
wr =<span class="st"> </span>BRW <span class="op">%&gt;%</span><span class="st"> </span>fortify <span class="op">%&gt;%</span><span class="st"> </span>data.table

bm =
<span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_polygon</span>(  <span class="dt">data =</span> bb, <span class="kw">aes</span>(long, lat), <span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">colour =</span> <span class="dv">1</span>, <span class="dt">size =</span> .<span class="dv">1</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_polygon</span>(  <span class="dt">data =</span> b,  <span class="kw">aes</span>(long, lat), <span class="dt">fill =</span> <span class="st">'dodgerblue4'</span>, <span class="dt">colour =</span> <span class="dv">1</span>, <span class="dt">size =</span> .<span class="dv">1</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_polygon</span>(  <span class="dt">data =</span> wr, <span class="kw">aes</span>(long, lat, <span class="dt">group =</span> group), <span class="dt">fill   =</span> <span class="st">'steelblue4'</span> , <span class="dt">colour =</span> <span class="st">'white'</span>, <span class="dt">size =</span> .<span class="dv">2</span>) <span class="op">+</span>
<span class="st">  </span>ggsn<span class="op">::</span><span class="kw">scalebar</span>(<span class="dt">data =</span> b,  <span class="dt">dist =</span> <span class="dv">100</span>, <span class="dt">st.size =</span> <span class="dv">3</span> ,<span class="dt">height =</span> .<span class="dv">01</span>) <span class="op">+</span>
<span class="st">  </span>rangeMapper<span class="op">::</span><span class="kw">theme_rangemap</span>()

<span class="kw">print</span>(bm)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">

### add tracks coloured with wind support
<span class="co"># Wind support scale</span>
col_Ws =<span class="st"> </span><span class="kw">c</span>(<span class="st">'firebrick4'</span>, <span class="st">'firebrick3'</span>, <span class="st">'gold'</span>, <span class="st">'springgreen3'</span>, <span class="st">'springgreen4'</span>, <span class="st">'springgreen4'</span>)

Ws   =<span class="st"> </span>d<span class="op">$</span>Ws <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>(.)
Ws_n =<span class="st"> </span>(<span class="op">-</span><span class="dv">6</span> <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(Ws)) <span class="op">/</span><span class="st"> </span>(<span class="kw">max</span>(Ws) <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(Ws))
Ws_<span class="dv">0</span> =<span class="st"> </span>(<span class="dv">0</span>  <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(Ws)) <span class="op">/</span><span class="st"> </span>(<span class="kw">max</span>(Ws) <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(Ws))
Ws_p =<span class="st"> </span>(<span class="dv">6</span>  <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(Ws)) <span class="op">/</span><span class="st"> </span>(<span class="kw">max</span>(Ws) <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(Ws))
Ws_m =<span class="st"> </span>(<span class="kw">max</span>(Ws)  <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(Ws)) <span class="op">/</span><span class="st"> </span>(<span class="kw">max</span>(Ws) <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(Ws))

col_WS_v  =<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, Ws_n, Ws_<span class="dv">0</span>, Ws_p, Ws_m, <span class="dv">1</span>)

<span class="co"># plots</span>
gi =
<span class="st">  </span>bm <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_path</span>(<span class="dt">data =</span> d, <span class="kw">aes</span>(x, y, <span class="dt">group =</span> bird_patch_id , <span class="dt">colour =</span> Ws), <span class="dt">lineend =</span> <span class="st">&quot;round&quot;</span>, <span class="dt">size =</span> <span class="fl">0.7</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_colour_gradientn</span>(<span class="dt">colours =</span> col_Ws, <span class="dt">values =</span> col_WS_v, <span class="dt">limits=</span><span class="kw">c</span>(<span class="kw">min</span>(d<span class="op">$</span>Ws, <span class="dt">na.rm =</span> T), <span class="kw">max</span>(d<span class="op">$</span>Ws, <span class="dt">na.rm =</span> T)), <span class="dt">name =</span> <span class="st">'Wind support (m/s)'</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.direction =</span> <span class="st">'horizontal'</span>, <span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="fl">0.12</span>, <span class="fl">0.13</span>),
        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">face =</span> <span class="st">'bold'</span>, <span class="dt">color =</span> <span class="st">'white'</span>),
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">face =</span> <span class="st">'bold'</span>, <span class="dt">color =</span> <span class="st">'white'</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">colour =</span> <span class="kw">guide_colourbar</span>(<span class="dt">title.position =</span> <span class="st">'top'</span>, <span class="dt">title.hjust =</span> <span class="fl">0.5</span>, <span class="dt">barwidth =</span> <span class="dv">8</span>))

gi</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">

<span class="co"># Function to extract legend (from: https://gist.github.com/crsh/be88be19233f1df4542aca900501f0fb#file-gglegend-r-L7)</span>
<span class="co"># otherwise plots without tracks would have no legend</span>

gglegend &lt;-<span class="st"> </span><span class="cf">function</span>(x){
  tmp &lt;-<span class="st"> </span><span class="kw">ggplot_gtable</span>(<span class="kw">ggplot_build</span>(x))
  leg &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">sapply</span>(tmp<span class="op">$</span>grobs, <span class="cf">function</span>(y) y<span class="op">$</span>name) <span class="op">==</span><span class="st"> &quot;guide-box&quot;</span>)
  tmp<span class="op">$</span>grobs[[leg]]
}


legend =<span class="st"> </span><span class="kw">gglegend</span>(gi)
<span class="co"># legend position</span>
legend<span class="op">$</span>vp<span class="op">$</span>x &lt;-<span class="st"> </span><span class="kw">unit</span>(.<span class="dv">13</span>, <span class="st">'npc'</span>)
legend<span class="op">$</span>vp<span class="op">$</span>y &lt;-<span class="st"> </span><span class="kw">unit</span>(.<span class="dv">08</span>, <span class="st">'npc'</span>)</code></pre></div>
</div>
<div id="create-particle-flow-animation-with-tracks-coloured-with-wind-support" class="section level2">
<h2>2. Create particle flow animation with tracks coloured with wind support</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Set time frame and path</span>
ts =<span class="st"> </span><span class="kw">data.table</span>(<span class="dt">date =</span> <span class="kw">seq</span>(<span class="st">'2014-06-05'</span> <span class="op">%&gt;%</span><span class="st"> </span>as.Date <span class="op">%&gt;%</span><span class="st"> </span>as.POSIXct, <span class="st">'2014-06-07'</span> <span class="op">%&gt;%</span><span class="st"> </span>as.Date <span class="op">%&gt;%</span><span class="st"> </span>as.POSIXct, <span class="dt">by =</span> <span class="st">'30 mins'</span>) )
<span class="kw">setkey</span>(ts, date)
tmp_path =<span class="st"> </span>wd <span class="co"># change path</span>
ts[, path <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">paste0</span>(tmp_path, <span class="st">'/'</span>, <span class="kw">str_pad</span>(<span class="dv">1</span><span class="op">:</span>.N, <span class="dv">4</span>, <span class="st">'left'</span>, <span class="dt">pad =</span> <span class="st">'0'</span>), <span class="st">'.png'</span>)   ]

<span class="co"># calculate last datetime of each point (to make it disappear at this point)</span>
d[, lastDate <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">max</span>(datetime_, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), by =<span class="st"> </span>bird_patch_id]
<span class="kw">setkey</span>(d,  datetime_)


<span class="co"># register parallel computing</span>
cl =<span class="st"> </span><span class="dv">20</span> <span class="op">%&gt;%</span><span class="st"> </span>makePSOCKcluster; <span class="kw">registerDoParallel</span>(cl)


<span class="co"># loop that creates pictures for the animation</span>
<span class="kw">foreach</span>(<span class="dt">i =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(ts), <span class="dt">.packages =</span> <span class="kw">c</span>(<span class="st">'scales'</span>, <span class="st">'ggplot2'</span>, <span class="st">'lubridate'</span>, <span class="st">'stringr'</span>, <span class="st">'data.table'</span>, <span class="st">'windR'</span>, <span class="st">'grid'</span>) ) <span class="op">%dopar%</span><span class="st"> </span>{

  <span class="kw">png</span>(<span class="dt">filename =</span> ts[i, path], <span class="dt">width =</span> <span class="dv">700</span>, <span class="dt">height =</span> <span class="dv">700</span>, <span class="dt">units =</span> <span class="st">&quot;px&quot;</span>, <span class="dt">pointsize =</span> <span class="dv">9</span>, <span class="dt">bg =</span> <span class="st">&quot;white&quot;</span>)

  <span class="co"># add track for particles</span>
  tail     =<span class="st"> </span><span class="dv">20</span>           <span class="co"># lenght of the running tail</span>
  tmp_date =<span class="st"> </span>ts[i]<span class="op">$</span>date   <span class="co"># current date</span>

  <span class="co"># subset particles</span>
  tmp_date_sub =<span class="st"> </span><span class="kw">seq</span>(tmp_date  <span class="op">-</span><span class="st"> </span><span class="dv">1800</span> <span class="op">*</span><span class="st"> </span>tail, tmp_date, <span class="dt">by =</span> <span class="st">'30 mins'</span>)
  pi =<span class="st"> </span>ob[<span class="kw">J</span>(tmp_date_sub), nomatch=0L]

  <span class="co"># add wind particles to base map</span>
  <span class="cf">if</span> (<span class="kw">nrow</span>(pi) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) pi[, a <span class="op">:</span><span class="er">=</span><span class="st">  </span><span class="kw">alphaAlong</span>(datetime_, <span class="dt">head =</span> <span class="dv">70</span>, <span class="dt">skew =</span> <span class="op">-</span><span class="dv">2</span>), by =<span class="st"> </span>particle_id] <span class="co"># alpha</span>

  bm_w =<span class="st"> </span>bm <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_path</span>(<span class="dt">data =</span> pi, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">group =</span> particle_id, <span class="dt">color =</span> w_speed), <span class="dt">alpha =</span> pi<span class="op">$</span>a) <span class="op">+</span>
<span class="st">     </span><span class="kw">scale_colour_gradientn</span>(<span class="dt">colours =</span> col_Ws, <span class="dt">values =</span> col_WS_v, 
                            <span class="dt">limits =</span> <span class="kw">c</span>(<span class="kw">min</span>(d<span class="op">$</span>Ws, <span class="dt">na.rm =</span> T), <span class="kw">max</span>(<span class="kw">c</span>(d<span class="op">$</span>Ws, ob<span class="op">$</span>w_speed), <span class="dt">na.rm =</span> T)), <span class="dt">name =</span> <span class="st">'Wind support (m/s)'</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">annotate</span>(<span class="st">'text'</span>, <span class="dt">x =</span> <span class="dv">0</span>, <span class="dt">y =</span> <span class="op">-</span><span class="dv">1730000</span>,
             <span class="dt">label =</span> <span class="kw">paste0</span>(<span class="st">'2014 '</span>, <span class="kw">format</span>(tmp_date, <span class="st">&quot;%B %d %H:00&quot;</span>)),
             <span class="dt">color =</span> <span class="st">'white'</span>, <span class="dt">size =</span> <span class="dv">8</span>, <span class="dt">fontface =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="co"># size = 5 normal resolution, 8 for high</span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">'none'</span>,
          <span class="dt">plot.margin =</span> <span class="kw">unit</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>), <span class="st">'cm'</span>))

  <span class="co"># add bird tracks</span>
  ki =<span class="st"> </span>d[datetime_ <span class="op">&lt;=</span><span class="st"> </span>tmp_date <span class="op">&amp;</span><span class="st"> </span>tmp_date <span class="op">&lt;</span><span class="st"> </span>lastDate]

  <span class="cf">if</span> (<span class="kw">nrow</span>(ki) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) ki[, a<span class="op">:</span><span class="er">=</span><span class="st">  </span><span class="kw">alphaAlong</span>(datetime_, <span class="dt">head =</span> <span class="dv">70</span>, <span class="dt">skew =</span> <span class="op">-</span><span class="fl">0.1</span>) ,     by =<span class="st"> </span>bird_patch_id] <span class="co"># alpha</span>
  <span class="cf">if</span> (<span class="kw">nrow</span>(ki) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) ki[, s<span class="op">:</span><span class="er">=</span><span class="st">  </span><span class="kw">sizeAlong</span>( datetime_, <span class="dt">head =</span> <span class="dv">70</span>, <span class="dt">to =</span> <span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">2.5</span>)) , by =<span class="st"> </span>bird_patch_id] <span class="co"># size</span>

  gi =
<span class="st">    </span>bm_w <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_path</span>(<span class="dt">data =</span> ki, <span class="kw">aes</span>(x, y, <span class="dt">group =</span> bird_patch_id , <span class="dt">colour =</span> Ws), <span class="dt">lineend =</span> <span class="st">&quot;round&quot;</span>,  <span class="dt">alpha =</span> ki<span class="op">$</span>a, <span class="dt">size =</span> ki<span class="op">$</span>s)


  <span class="cf">if</span> (<span class="kw">nrow</span>(ki) <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) {
    <span class="kw">print</span>(bm_w); <span class="kw">grid.draw</span>(legend)
  } <span class="cf">else</span> {
    <span class="kw">print</span>(gi); <span class="kw">grid.draw</span>(legend)
  }

  <span class="kw">dev.off</span>()

}



<span class="kw">stopCluster</span>(cl)
<span class="kw">registerDoSEQ</span>()


<span class="co"># merge png into animation using ffmpeg (or with a different programm)</span>

<span class="kw">setwd</span>(tmp_path)
<span class="kw">system</span>(<span class="st">&quot;ffmpeg -framerate 8 -pattern_type glob -i '*.png' -y -c:v libx264 -profile:v high -crf 1 -pix_fmt yuv420p Wind_particles_bird_tracks_animation.mov&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sessionInfo</span>()
<span class="co">#&gt; R version 3.4.3 (2017-11-30)</span>
<span class="co">#&gt; Platform: x86_64-pc-linux-gnu (64-bit)</span>
<span class="co">#&gt; Running under: Ubuntu 16.10</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Matrix products: default</span>
<span class="co">#&gt; BLAS: /usr/lib/openblas-base/libblas.so.3</span>
<span class="co">#&gt; LAPACK: /usr/lib/libopenblasp-r0.2.18.so</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; locale:</span>
<span class="co">#&gt;  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span>
<span class="co">#&gt;  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span>
<span class="co">#&gt;  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span>
<span class="co">#&gt;  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span>
<span class="co">#&gt;  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span>
<span class="co">#&gt; [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attached base packages:</span>
<span class="co">#&gt; [1] grid      parallel  stats     graphics  grDevices utils     datasets </span>
<span class="co">#&gt; [8] methods   base     </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; other attached packages:</span>
<span class="co">#&gt;  [1] stringr_1.3.0       ggplot2_2.2.1       doParallel_1.0.11  </span>
<span class="co">#&gt;  [4] iterators_1.0.9     foreach_1.4.4       rgeos_0.3-26       </span>
<span class="co">#&gt;  [7] gdalUtils_2.0.1.7   rgdal_1.2-18        windR_0.0.9        </span>
<span class="co">#&gt; [10] raster_2.6-7        sp_1.2-7            testthat_2.0.0     </span>
<span class="co">#&gt; [13] data.table_1.10.4-3 magrittr_1.5       </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; loaded via a namespace (and not attached):</span>
<span class="co">#&gt;  [1] Rcpp_0.12.16       lattice_0.20-35    png_0.1-7         </span>
<span class="co">#&gt;  [4] class_7.3-14       assertthat_0.2.0   rprojroot_1.3-2   </span>
<span class="co">#&gt;  [7] digest_0.6.12      R6_2.2.2           plyr_1.8.4        </span>
<span class="co">#&gt; [10] backports_1.1.2    RSQLite_2.0        evaluate_0.10.1   </span>
<span class="co">#&gt; [13] e1071_1.6-8        pillar_1.2.1       rlang_0.2.0       </span>
<span class="co">#&gt; [16] lazyeval_0.2.1     rstudioapi_0.7     praise_1.0.0      </span>
<span class="co">#&gt; [19] blob_1.1.1         R.utils_2.6.0      R.oo_1.21.0       </span>
<span class="co">#&gt; [22] reticulate_1.6     rmarkdown_1.9      labeling_0.3      </span>
<span class="co">#&gt; [25] devtools_1.13.5    foreign_0.8-69     bit_1.1-12        </span>
<span class="co">#&gt; [28] munsell_0.4.3      compiler_3.4.3     htmltools_0.3.6   </span>
<span class="co">#&gt; [31] gridExtra_2.3      tibble_1.4.2       roxygen2_6.0.1    </span>
<span class="co">#&gt; [34] codetools_0.2-15   crayon_1.3.4       withr_2.1.2       </span>
<span class="co">#&gt; [37] R.methodsS3_1.7.1  commonmark_1.4     jsonlite_1.5      </span>
<span class="co">#&gt; [40] gtable_0.2.0       DBI_0.8            scales_0.5.0      </span>
<span class="co">#&gt; [43] ncdf4_1.16         cli_1.0.0          stringi_1.1.7     </span>
<span class="co">#&gt; [46] ggsn_0.4.0         xml2_1.2.0         RColorBrewer_1.1-2</span>
<span class="co">#&gt; [49] tools_3.4.3        bit64_0.9-7        yaml_2.1.18       </span>
<span class="co">#&gt; [52] colorspace_1.3-2   rangeMapper_0.3-1  maptools_0.9-2    </span>
<span class="co">#&gt; [55] classInt_0.1-24    memoise_1.1.0      knitr_1.20</span></code></pre></div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
